/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as d,jsxs as I}from"@dropins/tools/preact-jsx-runtime.js";import{classes as f}from"@dropins/tools/lib.js";import*as p from"@dropins/tools/preact-compat.js";import{Suspense as R,lazy as t,useState as C,useRef as w}from"@dropins/tools/preact-compat.js";import{useState as P,useEffect as D}from"@dropins/tools/preact-hooks.js";const T=e=>p.createElement("svg",{id:"Icon_Check_Base","data-name":"Icon \\u2013 Check \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...e},p.createElement("g",{id:"Large"},p.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),p.createElement("g",{id:"Check_icon","data-name":"Check icon",transform:"translate(303.874 1434.583)"},p.createElement("path",{vectorEffect:"non-scaling-stroke",id:"Path_884137","data-name":"Path 884137",d:"M148,494.611l4.248,4.244,8.538-8.522",transform:"translate(-446.265 -1917.177)",fill:"none",stroke:"currentColor"})))),x=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"})),$=function(){const l=typeof document<"u"&&document.createElement("link").relList;return l&&l.supports&&l.supports("modulepreload")?"modulepreload":"preload"}(),S=function(e){return"/"+e},b={},r=function(l,s,a){let u=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));u=Promise.allSettled(s.map(i=>{if(i=S(i),i in b)return;b[i]=!0;const n=i.endsWith(".css"),m=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${m}`))return;const h=document.createElement("link");if(h.rel=n?"stylesheet":$,n||(h.as="script"),h.crossOrigin="",h.href=i,c&&h.setAttribute("nonce",c),document.head.appendChild(h),n)return new Promise((E,L)=>{h.addEventListener("load",E),h.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${i}`)))})}))}function _(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return u.then(o=>{for(const c of o||[])c.status==="rejected"&&_(c.reason);return l().catch(_)})},U=e=>e.reduce((s,a)=>{if(!a)return s;if(typeof a=="string"&&(s+=` ${a}`),Array.isArray(a)){const[u,_]=a;u&&_&&(s+=` ${u}`)}return s},"").trim(),O={Add:t(()=>r(()=>import("../chunks/Add.js"),[])),Bulk:t(()=>r(()=>import("../chunks/Bulk.js"),[])),Burger:t(()=>r(()=>import("../chunks/Burger.js"),[])),Cart:t(()=>r(()=>import("../chunks/Cart.js"),[])),Check:t(()=>r(()=>Promise.resolve().then(()=>x),void 0)),ChevronDown:t(()=>r(()=>import("../chunks/ChevronDown.js"),[])),ChevronUp:t(()=>r(()=>import("../chunks/ChevronUp.js"),[])),ChevronRight:t(()=>r(()=>import("../chunks/ChevronRight.js"),[])),Close:t(()=>r(()=>import("../chunks/Close.js"),[])),Heart:t(()=>r(()=>import("../chunks/Heart.js"),[])),Minus:t(()=>r(()=>import("../chunks/Minus.js"),[])),Placeholder:t(()=>r(()=>import("../chunks/Placeholder.js"),[])),PlaceholderFilled:t(()=>r(()=>import("../chunks/PlaceholderFilled.js"),[])),Search:t(()=>r(()=>import("../chunks/Search.js"),[])),SearchFilled:t(()=>r(()=>import("../chunks/SearchFilled.js"),[])),Sort:t(()=>r(()=>import("../chunks/Sort.js"),[])),Star:t(()=>r(()=>import("../chunks/Star.js"),[])),View:t(()=>r(()=>import("../chunks/View.js"),[])),User:t(()=>r(()=>import("../chunks/User.js"),[])),Warning:t(()=>r(()=>import("../chunks/Warning.js"),[])),Locker:t(()=>r(()=>import("../chunks/Locker.js"),[])),Wallet:t(()=>r(()=>import("../chunks/Wallet.js"),[])),Card:t(()=>r(()=>import("../chunks/Card.js"),[])),Order:t(()=>r(()=>import("../chunks/Order.js"),[])),Delivery:t(()=>r(()=>import("../chunks/Delivery.js"),[])),OrderError:t(()=>r(()=>import("../chunks/OrderError.js"),[])),OrderSuccess:t(()=>r(()=>import("../chunks/OrderSuccess.js"),[])),PaymentError:t(()=>r(()=>import("../chunks/PaymentError.js"),[])),CheckWithCircle:t(()=>r(()=>import("../chunks/CheckWithCircle.js"),[])),WarningWithCircle:t(()=>r(()=>import("../chunks/WarningWithCircle.js"),[])),WarningFilled:t(()=>r(()=>import("../chunks/WarningFilled.js"),[])),InfoFilled:t(()=>r(()=>import("../chunks/InfoFilled.js"),[])),HeartFilled:t(()=>r(()=>import("../chunks/HeartFilled.js"),[])),Trash:t(()=>r(()=>import("../chunks/Trash.js"),[])),Eye:t(()=>r(()=>import("../chunks/Eye.js"),[])),EyeClose:t(()=>r(()=>import("../chunks/EyeClose.js"),[])),Date:t(()=>r(()=>import("../chunks/Date.js"),[])),AddressBook:t(()=>r(()=>import("../chunks/AddressBook.js"),[])),EmptyBox:t(()=>r(()=>import("../chunks/EmptyBox.js"),[])),Coupon:t(()=>r(()=>import("../chunks/Coupon.js"),[])),Gift:t(()=>r(()=>import("../chunks/Gift.js"),[])),GiftCard:t(()=>r(()=>import("../chunks/GiftCard.js"),[])),Edit:t(()=>r(()=>import("../chunks/Edit.js"),[]))};function A(e){try{if(e.startsWith("//")){const s=`${window.location.protocol}${e}`;return new URL(s).hostname!==window.location.hostname?(console.error(`[Icon] External URL rejected for security: ${e} - Only same-domain URLs are allowed`),!1):!0}return new URL(e).hostname!==window.location.hostname?(console.error(`[Icon] External URL rejected for security: ${e} - Only same-domain URLs are allowed`),!1):!0}catch{return console.error(`[Icon] Invalid URL format: ${e}`),!1}}function N({url:e,...l}){const[s,a]=P(""),[u,_]=P(!0),[o,c]=P(!1);return D(()=>{fetch(e).then(i=>{if(!i.ok)throw console.error(`[Icon] Failed to fetch SVG: ${i.status} ${i.statusText}`),o;return i.text()}).then(i=>{try{if(!new DOMParser().parseFromString(i,"image/svg+xml").querySelector("svg"))throw new Error("No <svg> element found")}catch(m){m instanceof Error?console.error(`[Icon] Invalid SVG content from ${e}: ${m.message}`):console.error(`[Icon] Invalid SVG content from ${e}: ${String(m)}`),c(!0),_(!1)}let n=i;l.width&&(n=n.replace(/<svg([^>]*)\s+width\s*=\s*["'][^"']*["']/gi,"<svg$1"),n=n.replace(/<svg/i,`<svg width="${l.width}"`)),l.height&&(n=n.replace(/<svg([^>]*)\s+height\s*=\s*["'][^"']*["']/gi,"<svg$1"),n=n.replace(/<svg/i,`<svg height="${l.height}"`)),l.title&&(n=n.replace(/<title[^>]*>.*?<\/title>/gi,""),n=n.replace(/<svg([^>]*)>/i,`<svg$1><title>${l.title}</title>`)),a(n),_(!1)}).catch(i=>{i instanceof Error?console.error(`[Icon] ${i.message}`):console.error(`[Icon] ${String(i)}`),c(!0),_(!1)})},[e,l.width,l.height,l.title]),u||o?d("svg",{...l}):d("span",{className:l.className,style:{width:String(l.width),height:String(l.height),display:"inline-flex",lineHeight:0},dangerouslySetInnerHTML:{__html:s}})}function j({source:e,size:l="24",stroke:s="2",viewBox:a="0 0 24 24",className:u,..._}){const o={className:U(["dropin-icon",`dropin-icon--shape-stroke-${s}`,u]),width:l,height:l,viewBox:a},c=typeof e=="string"&&(e.startsWith("http")||e.startsWith("//")||e.startsWith("/"));if(c&&A(e))return d(R,{fallback:d("svg",{..._,...o}),children:d(N,{url:e,..._,...o})});const i=typeof e=="string"&&e in O?O[e]:null,n=c&&!A(e);return d(R,{fallback:d("svg",{..._,...o}),children:i?d(i,{..._,...o}):n?d("svg",{..._,...o}):d(e,{..._,...o})})}const W=({name:e,value:l,size:s="medium",disabled:a=!1,error:u=!1,label:_="",description:o="",className:c,checked:i,...n})=>{const[m,h]=C(i===void 0?!1:i),E=w(null),L=v=>{var g;(g=n.onChange)==null||g.call(n,v),h(v.currentTarget.checked)},V=v=>{var g;v.key===" "&&(v.preventDefault(),(g=E==null?void 0:E.current)==null||g.click())};return D(()=>{typeof i=="boolean"&&h(i)},[i]),I("label",{className:f(["dropin-checkbox",["dropin-checkbox--disabled",a]]),children:[d("input",{ref:E,name:e,value:l,type:"checkbox",disabled:a,className:f(["dropin-checkbox__checkbox",["dropin-checkbox__checkbox--error",u],c]),...n,onChange:L,checked:m}),I("div",{className:"dropin-checkbox__checkbox-icon",children:["â€‹",d("span",{"aria-checked":m?"true":"false","aria-labelledby":`${e}-label`,"aria-describedby":o?`${e}-description`:void 0,className:f(["dropin-checkbox__box",["dropin-checkbox__box--error",u],["dropin-checkbox__box--disabled",a]]),role:"checkbox",tabIndex:a?-1:0,onKeyDown:V,children:d(j,{className:f(["dropin-checkbox__checkmark"]),source:T,size:"16",stroke:"3"})})]}),d("div",{id:`${e}-label`,className:f(["dropin-checkbox__label",`dropin-checkbox__label--${s}`,["dropin-checkbox__label--disabled",a]]),children:_}),d("div",{}),o&&d("div",{id:`${e}-description`,role:"note",className:f(["dropin-checkbox__description",`dropin-checkbox__description--${s}`,["dropin-checkbox__description--disabled",a]]),children:o})]})},y=({className:e,checked:l,name:s,label:a,...u})=>d("div",{...u,className:f(["emailconsent-email-consent-ui-component",e]),children:d(W,{name:s,label:a,checked:l})}),H=({enable_sms_consent:e,enable_email_consent:l,sms_consent_label:s,email_consent_label:a,sms_consent_name:u,email_consent_name:_,checked:o,sms_disclosure:c,...i})=>I("div",{...i,children:[l&&d(y,{label:a,name:_,checked:o}),e&&I("div",{class:"sms-consent",children:[d(y,{label:s,name:u,checked:o}),d("div",{class:"sms-disclosure",children:c})]})]}),q=async(e,l,s,a,u,_,o)=>{let c=null,i=[];if(s){let n=k(e,l);Object.keys(n).length>0&&(console.log("---!"),console.log(n),i.push(n))}if(u){let n=k(e,l);Object.keys(n).length>0&&(console.log("---!"),console.log(n),i.push(n))}return console.log("---"),console.log(i),c},k=(e,l,s,a,u,_=!1)=>{var i,n,m;let o=l.data,c={};return _&&(c={data:{type:"profile",attributes:{email:e.email||null,phone_number:o.telephone||null,first_name:o.firstName||null,last_name:o.lastName||null,organization:o.company||null,location:{address1:((i=o.street)==null?void 0:i[0])||null,address2:((n=o.street)==null?void 0:n[1])||null,city:o.city||null,country:o.countryCode||null,region:((m=o.region)==null?void 0:m.regionCode)||null,zip:o.postcode||null}}}}),c};export{H as EmailConsentContainer,q as KlaviyoApiCreateUpdate,H as default};
//# sourceMappingURL=EmailConsentContainer.js.map
