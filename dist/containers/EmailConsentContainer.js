/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as m,jsxs as b}from"@dropins/tools/preact-jsx-runtime.js";import{classes as f}from"@dropins/tools/lib.js";import*as p from"@dropins/tools/preact-compat.js";import{Suspense as P,lazy as r,useState as C,useRef as w}from"@dropins/tools/preact-compat.js";import{useState as I,useEffect as D}from"@dropins/tools/preact-hooks.js";const T=t=>p.createElement("svg",{id:"Icon_Check_Base","data-name":"Icon \\u2013 Check \\u2013 Base",xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",...t},p.createElement("g",{id:"Large"},p.createElement("rect",{id:"Placement_area","data-name":"Placement area",width:24,height:24,fill:"#fff",opacity:0}),p.createElement("g",{id:"Check_icon","data-name":"Check icon",transform:"translate(303.874 1434.583)"},p.createElement("path",{vectorEffect:"non-scaling-stroke",id:"Path_884137","data-name":"Path 884137",d:"M148,494.611l4.248,4.244,8.538-8.522",transform:"translate(-446.265 -1917.177)",fill:"none",stroke:"currentColor"})))),x=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"})),$=function(){const n=typeof document<"u"&&document.createElement("link").relList;return n&&n.supports&&n.supports("modulepreload")?"modulepreload":"preload"}(),S=function(t){return"/"+t},O={},o=function(n,a,s){let u=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));u=Promise.allSettled(a.map(e=>{if(e=S(e),e in O)return;O[e]=!0;const i=e.endsWith(".css"),h=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${h}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":$,i||(d.as="script"),d.crossOrigin="",d.href=e,c&&d.setAttribute("nonce",c),document.head.appendChild(d),i)return new Promise((E,L)=>{d.addEventListener("load",E),d.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${e}`)))})}))}function _(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return u.then(l=>{for(const c of l||[])c.status==="rejected"&&_(c.reason);return n().catch(_)})},U=t=>t.reduce((a,s)=>{if(!s)return a;if(typeof s=="string"&&(a+=` ${s}`),Array.isArray(s)){const[u,_]=s;u&&_&&(a+=` ${u}`)}return a},"").trim(),R={Add:r(()=>o(()=>import("../chunks/Add.js"),[])),Bulk:r(()=>o(()=>import("../chunks/Bulk.js"),[])),Burger:r(()=>o(()=>import("../chunks/Burger.js"),[])),Cart:r(()=>o(()=>import("../chunks/Cart.js"),[])),Check:r(()=>o(()=>Promise.resolve().then(()=>x),void 0)),ChevronDown:r(()=>o(()=>import("../chunks/ChevronDown.js"),[])),ChevronUp:r(()=>o(()=>import("../chunks/ChevronUp.js"),[])),ChevronRight:r(()=>o(()=>import("../chunks/ChevronRight.js"),[])),Close:r(()=>o(()=>import("../chunks/Close.js"),[])),Heart:r(()=>o(()=>import("../chunks/Heart.js"),[])),Minus:r(()=>o(()=>import("../chunks/Minus.js"),[])),Placeholder:r(()=>o(()=>import("../chunks/Placeholder.js"),[])),PlaceholderFilled:r(()=>o(()=>import("../chunks/PlaceholderFilled.js"),[])),Search:r(()=>o(()=>import("../chunks/Search.js"),[])),SearchFilled:r(()=>o(()=>import("../chunks/SearchFilled.js"),[])),Sort:r(()=>o(()=>import("../chunks/Sort.js"),[])),Star:r(()=>o(()=>import("../chunks/Star.js"),[])),View:r(()=>o(()=>import("../chunks/View.js"),[])),User:r(()=>o(()=>import("../chunks/User.js"),[])),Warning:r(()=>o(()=>import("../chunks/Warning.js"),[])),Locker:r(()=>o(()=>import("../chunks/Locker.js"),[])),Wallet:r(()=>o(()=>import("../chunks/Wallet.js"),[])),Card:r(()=>o(()=>import("../chunks/Card.js"),[])),Order:r(()=>o(()=>import("../chunks/Order.js"),[])),Delivery:r(()=>o(()=>import("../chunks/Delivery.js"),[])),OrderError:r(()=>o(()=>import("../chunks/OrderError.js"),[])),OrderSuccess:r(()=>o(()=>import("../chunks/OrderSuccess.js"),[])),PaymentError:r(()=>o(()=>import("../chunks/PaymentError.js"),[])),CheckWithCircle:r(()=>o(()=>import("../chunks/CheckWithCircle.js"),[])),WarningWithCircle:r(()=>o(()=>import("../chunks/WarningWithCircle.js"),[])),WarningFilled:r(()=>o(()=>import("../chunks/WarningFilled.js"),[])),InfoFilled:r(()=>o(()=>import("../chunks/InfoFilled.js"),[])),HeartFilled:r(()=>o(()=>import("../chunks/HeartFilled.js"),[])),Trash:r(()=>o(()=>import("../chunks/Trash.js"),[])),Eye:r(()=>o(()=>import("../chunks/Eye.js"),[])),EyeClose:r(()=>o(()=>import("../chunks/EyeClose.js"),[])),Date:r(()=>o(()=>import("../chunks/Date.js"),[])),AddressBook:r(()=>o(()=>import("../chunks/AddressBook.js"),[])),EmptyBox:r(()=>o(()=>import("../chunks/EmptyBox.js"),[])),Coupon:r(()=>o(()=>import("../chunks/Coupon.js"),[])),Gift:r(()=>o(()=>import("../chunks/Gift.js"),[])),GiftCard:r(()=>o(()=>import("../chunks/GiftCard.js"),[])),Edit:r(()=>o(()=>import("../chunks/Edit.js"),[]))};function y(t){try{if(t.startsWith("//")){const a=`${window.location.protocol}${t}`;return new URL(a).hostname!==window.location.hostname?(console.error(`[Icon] External URL rejected for security: ${t} - Only same-domain URLs are allowed`),!1):!0}return new URL(t).hostname!==window.location.hostname?(console.error(`[Icon] External URL rejected for security: ${t} - Only same-domain URLs are allowed`),!1):!0}catch{return console.error(`[Icon] Invalid URL format: ${t}`),!1}}function j({url:t,...n}){const[a,s]=I(""),[u,_]=I(!0),[l,c]=I(!1);return D(()=>{fetch(t).then(e=>{if(!e.ok)throw console.error(`[Icon] Failed to fetch SVG: ${e.status} ${e.statusText}`),l;return e.text()}).then(e=>{try{if(!new DOMParser().parseFromString(e,"image/svg+xml").querySelector("svg"))throw new Error("No <svg> element found")}catch(h){h instanceof Error?console.error(`[Icon] Invalid SVG content from ${t}: ${h.message}`):console.error(`[Icon] Invalid SVG content from ${t}: ${String(h)}`),c(!0),_(!1)}let i=e;n.width&&(i=i.replace(/<svg([^>]*)\s+width\s*=\s*["'][^"']*["']/gi,"<svg$1"),i=i.replace(/<svg/i,`<svg width="${n.width}"`)),n.height&&(i=i.replace(/<svg([^>]*)\s+height\s*=\s*["'][^"']*["']/gi,"<svg$1"),i=i.replace(/<svg/i,`<svg height="${n.height}"`)),n.title&&(i=i.replace(/<title[^>]*>.*?<\/title>/gi,""),i=i.replace(/<svg([^>]*)>/i,`<svg$1><title>${n.title}</title>`)),s(i),_(!1)}).catch(e=>{e instanceof Error?console.error(`[Icon] ${e.message}`):console.error(`[Icon] ${String(e)}`),c(!0),_(!1)})},[t,n.width,n.height,n.title]),u||l?m("svg",{...n}):m("span",{className:n.className,style:{width:String(n.width),height:String(n.height),display:"inline-flex",lineHeight:0},dangerouslySetInnerHTML:{__html:a}})}function N({source:t,size:n="24",stroke:a="2",viewBox:s="0 0 24 24",className:u,..._}){const l={className:U(["dropin-icon",`dropin-icon--shape-stroke-${a}`,u]),width:n,height:n,viewBox:s},c=typeof t=="string"&&(t.startsWith("http")||t.startsWith("//")||t.startsWith("/"));if(c&&y(t))return m(P,{fallback:m("svg",{..._,...l}),children:m(j,{url:t,..._,...l})});const e=typeof t=="string"&&t in R?R[t]:null,i=c&&!y(t);return m(P,{fallback:m("svg",{..._,...l}),children:e?m(e,{..._,...l}):i?m("svg",{..._,...l}):m(t,{..._,...l})})}const B=({name:t,value:n,size:a="medium",disabled:s=!1,error:u=!1,label:_="",description:l="",className:c,checked:e,...i})=>{const[h,d]=C(e===void 0?!1:e),E=w(null),L=v=>{var g;(g=i.onChange)==null||g.call(i,v),d(v.currentTarget.checked)},V=v=>{var g;v.key===" "&&(v.preventDefault(),(g=E==null?void 0:E.current)==null||g.click())};return D(()=>{typeof e=="boolean"&&d(e)},[e]),b("label",{className:f(["dropin-checkbox",["dropin-checkbox--disabled",s]]),children:[m("input",{ref:E,name:t,value:n,type:"checkbox",disabled:s,className:f(["dropin-checkbox__checkbox",["dropin-checkbox__checkbox--error",u],c]),...i,onChange:L,checked:h}),b("div",{className:"dropin-checkbox__checkbox-icon",children:["â€‹",m("span",{"aria-checked":h?"true":"false","aria-labelledby":`${t}-label`,"aria-describedby":l?`${t}-description`:void 0,className:f(["dropin-checkbox__box",["dropin-checkbox__box--error",u],["dropin-checkbox__box--disabled",s]]),role:"checkbox",tabIndex:s?-1:0,onKeyDown:V,children:m(N,{className:f(["dropin-checkbox__checkmark"]),source:T,size:"16",stroke:"3"})})]}),m("div",{id:`${t}-label`,className:f(["dropin-checkbox__label",`dropin-checkbox__label--${a}`,["dropin-checkbox__label--disabled",s]]),children:_}),m("div",{}),l&&m("div",{id:`${t}-description`,role:"note",className:f(["dropin-checkbox__description",`dropin-checkbox__description--${a}`,["dropin-checkbox__description--disabled",s]]),children:l})]})},k=({className:t,checked:n,name:a,label:s,...u})=>m("div",{...u,className:f(["emailconsent-email-consent-ui-component",t]),children:m(B,{name:a,label:s,checked:n})}),H=({enable_sms_consent:t,enable_email_consent:n,sms_consent_label:a,email_consent_label:s,sms_consent_name:u,email_consent_name:_,checked:l,sms_disclosure:c,...e})=>b("div",{...e,children:[n&&m(k,{label:s,name:_,checked:l}),t&&b("div",{class:"sms-consent",children:[m(k,{label:a,name:u,checked:l}),m("div",{class:"sms-disclosure",children:c})]})]}),q=async(t,n,a,s,u,_,l)=>{let c={data:{id:"111"}},e=null,i="111";c?(console.log("test1"),e=c):console.log("test");let h=[];if(e&&Object.keys(e.data).length>0&&(i=e.data.id),a){let d=A(t,n,"email",i,s);Object.keys(d).length>0&&(console.log("---!!"),console.log(d),h.push(d))}if(u){let d=A(t,n,"sms",i,_);Object.keys(d).length>0&&(console.log("---!"),console.log(d),h.push(d))}return console.log("---"),console.log(h),e},A=(t,n,a,s,u,_=!1)=>{var h,d,E;let l={},c={},e=n.data,i={};return _&&(i={data:{type:"profile",attributes:{email:t.email||null,phone_number:e.telephone||null,first_name:e.firstName||null,last_name:e.lastName||null,organization:e.company||null,location:{address1:((h=e.street)==null?void 0:h[0])||null,address2:((d=e.street)==null?void 0:d[1])||null,city:e.city||null,country:e.countryCode||null,region:((E=e.region)==null?void 0:E.regionCode)||null,zip:e.postcode||null}}}}),_||(a==="email"&&s&&(i={data:{type:"profile",id:s,attributes:{email:t.email||null}}},l.email={marketing:{consent:"SUBSCRIBED"}}),a==="sms"&&s&&(i={data:{type:"profile",id:s,attributes:{phone_number:e.telephone||null}}},l.sms={marketing:{consent:"SUBSCRIBED"}}),s&&Object.keys(l).length>0&&(i.data.attributes.subscriptions=l),u&&(c.list={data:{type:"list",id:u}}),s&&u&&Object.keys(c.list.data).length>0&&(i.data.relationships=c)),i};export{H as EmailConsentContainer,q as KlaviyoApiCreateUpdate,H as default};
//# sourceMappingURL=EmailConsentContainer.js.map
